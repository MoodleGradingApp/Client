<!--
-- Authors: Michael Sisko and Emily Costa
-- Citation(s):
--      Auto-sizing Text-box: https://stackoverflow.com/questions/2803880/ by Martin Prestone
--
-->

<head>
    <title>Grading Assistant</title>
</head>

<div class="panel panel-default hide-outline" id="outer-card">
    <p>Developed by: Michael Sisko and Emily Costa</p>
    <h1>Grading Assistant</h1>
    <hr>
    <div class="row">
        <div class="col fixed-panel" id="main-left-panel">
            <div class="panel panel-default">
                <div class="panel panel-default hide-outline tight" id="item-info">
                    <div id="assignment">
                        <!-- <p *ngIf="correctFile == false">Testting!!</p> -->
                        <label for="assignment">Assignment:&nbsp;</label>
                        <input
                        class="input-box"
                        type="text"
                        id="assignment"
                        name="assignment"
                        placeholder="Ex. Homework #1"
                        data-testid="nameInput"
                        >
                    </div>
                    <div id="max-pts">
                        <label for="max-pts">Max Points:&nbsp;</label>
                        {{maxScore}}
                    </div>
                </div>
                <div class="panel panel-default hide-outline tight" id="main-btn-set">
                    <button type="button" class="btn-primary-blue" (click)="previousStudent()" data-testid="prevStudentBtn">Prev Student</button>
                    <button type="button" class="btn-primary-blue" (click)="nextStudent()" data-testid="nextStudentBtn">Next Student</button>
                    <button type="button" class="btn-primary-blue">Export Table</button>
                    <button type="button" class="btn-primary-blue">Stats</button>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel panel-default hide-outline tight">
                    <label for="Student">Student Name: {{currentStudentName}}</label>
                    <button type="button" id="save-btn" class="btn-primary-green">Save Progress</button>
                </div>
                <br>
                <!-- FEEDBACK INPUT NEEDS TO BE CHANGED -->
                <form [formGroup]="feedbackForm">
                    <table class="feedbackTable">
                        <thead>
                            <thead>
                                <li>&nbsp;&nbsp;&nbsp;&nbsp;</li>
                                <li id="feedback-head">
                                    <th>Feedback</th>
                                </li>
                                <li id="deduction-head">
                                    <th>Deduction</th>
                                </li>
                                <li></li>
                            </thead>
                        </thead>
                        <tbody formArrayName="feedbackArray" *ngFor="let feedback of feedbackControls; let i = index">
                            <tr [formGroupName]="i">
                                <li>
                                    <input id="selected" type="checkbox">
                                </li>
                                <li class="feedback-column">
                                    <!-- Dynamic textbox citation in header -->
                                    <textarea
                                    class="input-box feedback"
                                    name="text"
                                    oninput='this.style.height = ""; this.style.height = this.scrollHeight + 2 + "px"'
                                    placeholder="Say something constructive..."
                                    data-testid="feedbackInput"></textarea>
                                </li>
                                <li class="deduction-column">
                                    <input
                                    id="deduction"
                                    class="input-box deduction"
                                    type="number"
                                    name="deduction"
                                    min=0
                                    size=3
                                    placeholder=0
                                    data-testid="deductionInput">
                                </li>
                                <li>
                                    <button
                                    class="btn-primary-trash"
                                    type="button" id="trash-btn"
                                    name="trashButton"
                                    (click)="removeFeedback(i)"
                                    size=2
                                    data-testid="trashBtn"
                                    >X</button>
                                    <!-- Replace X char with actual icon-->
                                </li>
                            </tr>
                        </tbody>
                    </table>
                </form>
                <br>
                <button
                type="button"
                class="btn-primary-blue"
                (click)="addFeedback()"
                data-testid="addFeedbackBtn"
                >Add Feedback</button>
                <br><br>
            </div>
        </div>
        <div class="panel panel-default" id="main-right-panel">
            <div class="csv-import-btn">
    <input
        type="file"
        #fileImportInput
        name="File Upload"
        id="csvFileUpload"
        accept=".csv"
        data-testid="importCSV"
        (change)="fileChangeListener($event)"/>
    <p *ngIf="validFile == false" class="file-warning">*Invalid CSV File</p>
</div>
<div class="csv-result-table">
    <table class="csvTable">
        <thead>
            <tr>
                <th>#</th>
                <th>Name</th>
                <th>Email</th>
                <th>Timestamp</th>
                <th>Grade</th>
                <th>Feedback</th>
            </tr>
        </thead>
        <tbody>
            <tr class="csv-data" *ngFor="let csvData of csvRecords; let i = index;" (click)="rowSelected(i)" (click)="highlightRow(i)">
                <td>{{i+1}}</td>
                <td>{{csvData.fullName}}</td>
                <td>{{csvData.email}}</td>
                <td>{{csvData.gradeLastModified}}</td>
                <td>{{csvData.grade}}</td>
                <td>{{csvData.feedback}}</td>
            </tr>
        </tbody>
    </table>
</div>